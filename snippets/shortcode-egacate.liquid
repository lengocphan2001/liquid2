{%capture handleColl-%}{% include 'shortcode-render' render:'handle' default:'' -%}{%endcapture-%}
{%capture limit-%}{% include 'shortcode-render' render:'limit' default:'' -%}{%endcapture-%}

<style>
@media (max-width: 768px) {
	.ega-cate-shortcode .row {
		flex-wrap: nowrap;
		overflow: auto;
	}
	.ega-cate-shortcode .row::-webkit-scrollbar {
		display: none;
	}
	.ega-cate-shortcode .row {
		-ms-overflow-style: none;
		/* IE and Edge */
		scrollbar-width: none;
		/* Firefox */
	}
	.ega-cate-shortcode .row .col-12 {
		padding: 5px;
	}
	.ega-cate-shortcode .row .item.product-col{
		flex: 0 0 70%;
		max-width: 70%;
	}
}
</style>
{%assign collection = collections[handleColl]%}
{% if collection.products.size > 0 -%}
<div class="ega-cate-shortcode container">
	<div class="row">
		{% for product in collection.products limit: limit -%}
		<div class="item product-col {%if limit >= 3 %} col-7 col-md-4 col-lg-4 {%else %} col {%endif%}">
	<div class="item_product_main">
		{% include 'product_grid_office' %}
	</div>
</div>
	{%endfor%}
	</div>
	
</div>
<script>
function relatedProductSlide(){
		if(window.matchMedia('(min-width: 768px)').matches && $('.ega-cate-shortcode .item').length >=3){
		$('.ega-cate-shortcode .row:not(.slick-initialized)').each(function(){
			$(this).slick({
				autoplay: false,
				autoplaySpeed: 6000,
				dots: false,
				arrows: true,
				infinite: false,
				speed: 300,
				slidesToShow: 3,
				slidesToScroll: 1,
				centerMode: false,
				responsive: [
					{
						breakpoint: 1200,
						settings: {
							slidesToShow: 3,
							slidesToScroll: 1
						}
					},
					{
						breakpoint: 1024,
						settings: {
							slidesToShow: 3,
							slidesToScroll: 1
						}
					},
					{
						breakpoint: 767,
						settings: {
							slidesToShow: 2,
							slidesToScroll: 2
						}
					}
				]
			});
		
		})
			
		}
	}
	relatedProductSlide()
</script>
{%endif%}